<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<title>主题展示详情</title>

		<link href="../../assets/bootstrap-3.3.5/dist/css/bootstrap.min.css" type="text/css" rel="stylesheet" />
		<link href="../../assets/bootstrap-3.3.5/docs/examples/signin/signin.css" rel="stylesheet">
		<script src="../../assets/bootstrap-3.3.5/docs/assets/js/ie-emulation-modes-warning.js"></script>
		<script src="../../assets/jQuery/2.x/jquery-2.1.4.min.js"></script>
		<script src="../../assets/bootstrap-3.3.5/dist/js/bootstrap.min.js"></script>
		<script src="../../assets/bootstrap-3.3.5/docs/assets/js/vendor/holder.min.js"></script>
		<script src="../../assets/bootstrap-3.3.5/docs/assets/js/ie10-viewport-bug-workaround.js"></script>
	</head>

	<body>
		
		<div class="container">
			<div class="form-horizontal">
			<div class="form-group">
			   <label for="userName" class="col-sm-2 control-label">卖家姓名</label>
			    <div class="col-sm-5">
			      <label class="form-control" name="userName" id="userName"></label>
			    </div>
			    <div class="col-sm-5">
			    	<button class="btn btn-default">信用等级
			    		<span class="glyphicon glyphicon-star"></span>
			    		<span class="glyphicon glyphicon-star"></span>
			    		<span class="glyphicon glyphicon-star"></span>
			    		<span class="glyphicon glyphicon-star"></span>
			    		<span class="glyphicon glyphicon-star"></span>
			    	</button>
			    	<a href="" class="btn btn-danger" style="float: right;">投诉</a>
			    </div>
			  </div>
			  <div class="form-group">
			    <label for="themeTitle" class="col-sm-2 control-label">主题</label>
			    <div class="col-sm-10">
			      <label class="form-control" name="themeTitle" id="themeTitle">主题</label>
			    </div>
			  </div>
			  
			  <div class="form-group">
			    <label for="themeContent" class="col-sm-2 control-label">内容</label>
			    <div class="col-sm-10">
			      <label class="form-control" name="themeContent" id="themeContent">内容</label>
			    </div>
			  </div>
			  
			  <div class="form-group">
			    <label for="themeTime" class="col-sm-2 control-label">发布时间</label>
			    <div class="col-sm-10">
			      <label class="form-control" name="themeTime" id="themeTime">发布时间</label>
			    </div>
			  </div>
			  
			
			  <div class="form-group">
			    <label for="commodityName" class="col-sm-2 control-label">商品名称</label>
			    <div class="col-sm-10">
			      <label class="form-control" name="commodityName" id="commodityName">商品名称</label>
			    </div>
			  </div>
			  
			  <div class="form-group">
			    <label for="commodityCategary" class="col-sm-2 control-label">商品类型</label>
			    <div class="col-sm-10">
			      <label class="form-control" name="commodityCategary" id="commodityCategary">商品类型</label>
			    </div>
			  </div>
			  
			  <div class="form-group">
			    <label for="commodityCount" class="col-sm-2 control-label">商品数量</label>
			    <div class="col-sm-10">
			      <label class="form-control" name="commodityCount" id="commodityCount">商品数量</label>
			    </div>
			  </div>
			  
			  <div class="form-group">
			    <label for="commodityStatus" class="col-sm-2 control-label">商品状态</label>
			    <div class="col-sm-10">
			      	<label name="commodityStatus" id="commodityStatus" class="form-control">新品上架</label>
			    </div>
			  </div>
			  
			   <div class="form-group">
			    <label for="commodityOldNewLevel" class="col-sm-2 control-label">新旧程度</label>
			    <div class="col-sm-10">
			      	<label name="commodityOldNewLevel" id="commodityOldNewLevel" class="form-control">新旧程度</label>
			    </div>
			  </div>
			 
			  <div class="form-group">
			    <label for="commodityOldPrice" class="col-sm-2 control-label">商品原价</label>
			    <div class="col-sm-10">
			      <label class="form-control" name="commodityOldPrice" id="commodityOldPrice">商品原价</label>
			    </div>
			  </div>
			  
			  <div class="form-group">
			    <label for="commodityNewPrice" class="col-sm-2 control-label">商品现价</label>
			    <div class="col-sm-10">
			      <label class="form-control" name="commodityNewPrice" id="commodityNewPrice">商品现价</label>
			    </div>
			  </div>
			  
			  <div class="form-group">
			    <label for="commodityDownDay" class="col-sm-2 control-label">下架天数</label>
			    <div class="col-sm-10">
			      <label class="form-control" name="commodityDownDay" id="commodityDownDay">下架天数</label>
			    </div>
			  </div>
			  
			  <div class="form-group">
			    <label for="commodityPicture" class="col-sm-2 control-label">物品图片</label>
			    <div class="col-sm-10">
			      <img src="" alt="图片加载失败" style="width: 100%;height: 300px;" class="form-control" name="commodityPicture" id="commodityPicture">
			    </div>
			  </div>
			  
			  <div class="form-group">
			    <label for="commodityDescribe" class="col-sm-2 control-label">商品描述</label>
			    <div class="col-sm-10">
			      <label class="form-control" name="commodityDescribe" id="commodityDescribe">商品描述</label>
			    </div>
			  </div>
			</div>
			
			
				<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
				  <div class="modal-dialog">
				    <div class="modal-content">
				      <div class="modal-header">
				        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
				        <h4 class="modal-title" id="myModalLabel">回复该主题</h4>
				      </div>
				      <div class="modal-body">
				      	<textarea id="intputReplyContent" name="intputReplyContent" class="form-control" placeholder="请输入" rows="3"></textarea>
				      
				      </div>
				      <div class="modal-footer">
				        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
				        <button type="button" class="btn btn-primary" name="toReply" id="toReply">发送</button>
				      </div>
				    </div>
				  </div>
				</div>
						
			
			
			<table class="table table-hover" id="table" style="visibility: hidden;">
				<thead>
					<tr>
						<th>回复内容</th>
						<th>回复时间</th>
						<th>回复人</th>
					</tr>
				</thead>
				<tbody id="getReplyItems">
				</tbody>
			</table>
				<!-- 内容，回复时间，回复人名称 -->
				
				
				
				
			<div class="form-group">
				 <div class="col-sm-12">
					    <button type="button" class="form-control btn-primary" data-toggle="modal" data-target="#myModal">
								  进行回复
						</button>
				 </div>
			</div>		
				
		</div>
			<script>
				var themeId;
				$(document).ready(function() {
					getThemes();
					getReplys();
					sendReplyContent();
				});
				
				function sendReplyContent() {
					$("#toReply").bind('click', function() {
						$.get("/secondaryMarket/UploadReply",{
							replyContent : $("#intputReplyContent").val().trim(),
							replyThemeId : themeId
						},function(data, textStatus) {
							//alert(data.isSuccess);
							if(textStatus == "success") {
								if(data.isSuccess=="true") {
									$("#myModal").modal("hide");
									getReplys();
								} else {
									alert("请先登录");
								}
							} else {
								alert("请刷新重试！");
							}
						},"json");
					});
				}
				
				function getReplys() {
					$.get('/secondaryMarket/GetReply',{
						themeId : themeId
					},function(data, textStatus) {
						if(textStatus == "success") {
							$("#table").attr("style", "visibility: visible");
							$("#getReplyItems").empty();
							for(var i = 0; i < data.replys.length; i++) {
								var tbody = $('<tr></tr>');
								var td = $('<td></td>');
								td.text(data.replys[i].replyContent);
								td.appendTo(tbody);
								var td1 = $('<td></td>');
								td1.text(data.replys[i].replyTime);
								td1.appendTo(tbody);
								
								var td2 = $('<td></td>');
								td2.text(data.users[i].userNackName);
								td2.appendTo(tbody);
								
								tbody.appendTo($("#getReplyItems"));
							}
						} else {
							alert("请刷新重试！");
						}
					}, "json");
				}
				
				function getThemes() {
					themeId = getThemeId(window.location.href);
					$.get('/secondaryMarket/GetTheme',{
						isOne : true,
						themeId : themeId
					},function(data, textStatus) {
						if(textStatus == "success") {
							//alert(data.theme.themeTitle);
							
							$("#userName").text(data.user.userNackName);
							$("#themeTitle").text(data.theme.themeTitle);
							$("#themeContent").text(data.theme.themeContent);
							$("#themeTime").text(data.theme.themeTime);
							
							$("#commodityName").text(data.commodity.commodityName);
							$("#commodityCategary").text(data.commodity.commodityCategary);
							$("#commodityStatus").text(data.commodity.commodityStatus);
							$("#commodityCount").text(data.commodity.commodityCount);
							$("#commodityDescribe").text(data.commodity.commodityDescribe);
							$("#commodityOldNewLevel").text(data.commodity.commodityOldNewLevel);
							$("#commodityOldPrice").text(data.commodity.commodityOldPrice);
							$("#commodityNewPrice").text(data.commodity.commodityNewPrice);
							$("#commodityDownDay").text(data.commodity.commodityDownDay);
							$("#commodityPicture").attr("src", "/secondaryMarket/img/"+data.commodity.commodityPicture);
							
							
						} else {
							alert("请刷新重试！");
						}
					},"json");
				}
				function getThemeId(href) {
					var themeIdStr = href.split("&")[1];
					var themeId = themeIdStr.split("=")[1];
					return themeId;
				}
				
			</script>
	</body>
</html>